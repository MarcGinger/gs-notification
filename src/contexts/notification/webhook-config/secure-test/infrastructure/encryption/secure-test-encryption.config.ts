// @generated by gen v1.0.0 hash:regen
// REMOVE THIS COMMENT TO STOP AUTOMATIC UPDATES TO THIS BLOCK

/**
 * SecureTest Encryption Configuration
 *
 * Domain-specific encryption configuration for SecureTest entities.
 * Centralizes field mappings and namespace configuration to ensure
 * consistency across Writer, Reader, Query repositories and Projector.
 *
 * @domain Notification - NotificationWebhookConfig - SecureTest
 * @layer Infrastructure - Configuration
 */

import { EncryptionConfig } from 'src/shared/infrastructure/encryption';
import { EventEncryptionFactory } from 'src/shared/infrastructure/encryption';

/**
 * SecureTest domain-specific encryption field configuration
 */
export const SECURE_TEST_ENCRYPTION_CONFIG = {
  /**
   * Fields that contain sensitive data requiring encryption
   */
  SENSITIVE_FIELDS: ['signingSecret', 'username', 'password'] as const,

  /**
   * Namespace mapping for different credential types
   * - signingSecret: Webhook-related secrets
   * - username/password: Authentication credentials
   */
  NAMESPACE_MAP: {
    signingSecret: 'auth',
    username: 'auth',
    password: 'auth',
  } as const,

  /**
   * Default namespace for general SecureTest encryption operations
   */
  DEFAULT_NAMESPACE: 'secure-test',
} as const;

/**
 * SecureTest Encryption Configuration Helper
 *
 * Provides centralized configuration factory for SecureTest domain encryption.
 * Ensures consistent field mappings and namespace configuration across all
 * SecureTest repositories and projectors.
 */
export class SecureTestEncryptionConfig {
  /**
   * Create SecretRef encryption configuration for SecureTest domain
   *
   * @returns Configured EncryptionConfig for SecureTest SecretRef encryption
   */
  static createSecretRefConfig(): EncryptionConfig {
    return EventEncryptionFactory.createSecretConfig({
      sensitiveFields: [...SECURE_TEST_ENCRYPTION_CONFIG.SENSITIVE_FIELDS],
      namespaceMap: { ...SECURE_TEST_ENCRYPTION_CONFIG.NAMESPACE_MAP },
      defaultNamespace: SECURE_TEST_ENCRYPTION_CONFIG.DEFAULT_NAMESPACE,
    });
  }

  /**
   * Create Doppler encryption configuration for SecureTest domain
   *
   * @returns Configured EncryptionConfig for SecureTest Doppler encryption
   */
  static createDopplerConfig(): EncryptionConfig {
    return EventEncryptionFactory.createDopplerConfig({
      sensitiveFields: [...SECURE_TEST_ENCRYPTION_CONFIG.SENSITIVE_FIELDS],
      namespaceMap: { ...SECURE_TEST_ENCRYPTION_CONFIG.NAMESPACE_MAP },
      defaultNamespace: SECURE_TEST_ENCRYPTION_CONFIG.DEFAULT_NAMESPACE,
    });
  }

  /**
   * Get sensitive field names for SecureTest domain
   *
   * @returns Array of field names that require encryption
   */
  static getSensitiveFields(): readonly string[] {
    return SECURE_TEST_ENCRYPTION_CONFIG.SENSITIVE_FIELDS;
  }

  /**
   * Get namespace mapping for SecureTest credentials
   *
   * @returns Mapping of field names to namespace identifiers
   */
  static getNamespaceMap(): typeof SECURE_TEST_ENCRYPTION_CONFIG.NAMESPACE_MAP {
    return SECURE_TEST_ENCRYPTION_CONFIG.NAMESPACE_MAP;
  }
}
