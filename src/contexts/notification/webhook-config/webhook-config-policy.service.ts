// @generated by gen v1.0.0 hash:regen
// REMOVE THIS COMMENT TO STOP AUTOMATIC UPDATES TO THIS BLOCK

// webhook-config PII Policy Registration
// Registers domain-specific PII policy with the shared policy provider

import { Injectable, OnModuleInit } from '@nestjs/common';
import {
  registerDomainPolicy,
  PIIPolicyBundle,
} from 'src/shared/services/compliance';

export const WEBHOOK_CONFIG_POLICY: PIIPolicyBundle = {
  domain: 'webhook-config',
  keywords: {
    include: [], // don't blanket-flag "name"
    exclude: [], // ensure no accidental catch-all
  },
  rules: [
    // Exact field paths that are PII
    { match: 'signingSecret', action: 'pii', category: 'sensitive' },
    // Explicit exceptions (non-PII)
  ],
};

@Injectable()
export class WebhookConfigPolicyService implements OnModuleInit {
  onModuleInit() {
    // Register webhook-config domain policy during module initialization
    registerDomainPolicy(WEBHOOK_CONFIG_POLICY);
  }
}
