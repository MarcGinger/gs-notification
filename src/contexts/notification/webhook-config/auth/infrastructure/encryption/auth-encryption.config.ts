// @generated by gen v1.0.0 hash:regen
// REMOVE THIS COMMENT TO STOP AUTOMATIC UPDATES TO THIS BLOCK

/**
 * Auth Encryption Configuration
 *
 * Domain-specific encryption configuration for Auth entities.
 * Centralizes field mappings and namespace configuration to ensure
 * consistency across Writer, Reader, Query repositories and Projector.
 *
 * @domain Notification - NotificationWebhookConfig - Auth
 * @layer Infrastructure - Configuration
 */

import { EncryptionConfig } from 'src/shared/infrastructure/encryption';
import { EventEncryptionFactory } from 'src/shared/infrastructure/encryption';

/**
 * Auth domain-specific encryption field configuration
 */
export const AUTH_ENCRYPTION_CONFIG = {
  /**
   * Fields that contain sensitive data requiring encryption
   */
  SENSITIVE_FIELDS: [
    'signingSecret',

    'username',
    'password',
    'apiKey',

    'clientSecret',

    'cert',
    'key',
    'ca',
  ] as const,

  /**
   * Namespace mapping for different credential types
   * - signingSecret: Webhook-related secrets
   * - username/password: Authentication credentials
   */
  NAMESPACE_MAP: {
    signingSecret: 'auth',
    username: 'auth',
    password: 'auth',
    apiKey: 'auth',
    clientSecret: 'auth',
    cert: 'auth',
    key: 'auth',
    ca: 'auth',
  } as const,

  /**
   * Default namespace for general Auth encryption operations
   */
  DEFAULT_NAMESPACE: 'auth',
} as const;

/**
 * Auth Encryption Configuration Helper
 *
 * Provides centralized configuration factory for Auth domain encryption.
 * Ensures consistent field mappings and namespace configuration across all
 * Auth repositories and projectors.
 */
export class AuthEncryptionConfig {
  /**
   * Create SecretRef encryption configuration for Auth domain
   *
   * @returns Configured EncryptionConfig for Auth SecretRef encryption
   */
  static createSecretRefConfig(): EncryptionConfig {
    return EventEncryptionFactory.createSecretConfig({
      sensitiveFields: [...AUTH_ENCRYPTION_CONFIG.SENSITIVE_FIELDS],
      namespaceMap: { ...AUTH_ENCRYPTION_CONFIG.NAMESPACE_MAP },
      defaultNamespace: AUTH_ENCRYPTION_CONFIG.DEFAULT_NAMESPACE,
    });
  }

  /**
   * Create Doppler encryption configuration for Auth domain
   *
   * @returns Configured EncryptionConfig for Auth Doppler encryption
   */
  static createDopplerConfig(): EncryptionConfig {
    return EventEncryptionFactory.createDopplerConfig({
      sensitiveFields: [...AUTH_ENCRYPTION_CONFIG.SENSITIVE_FIELDS],
      namespaceMap: { ...AUTH_ENCRYPTION_CONFIG.NAMESPACE_MAP },
      defaultNamespace: AUTH_ENCRYPTION_CONFIG.DEFAULT_NAMESPACE,
    });
  }

  /**
   * Get sensitive field names for Auth domain
   *
   * @returns Array of field names that require encryption
   */
  static getSensitiveFields(): readonly string[] {
    return AUTH_ENCRYPTION_CONFIG.SENSITIVE_FIELDS;
  }

  /**
   * Get namespace mapping for Auth credentials
   *
   * @returns Mapping of field names to namespace identifiers
   */
  static getNamespaceMap(): typeof AUTH_ENCRYPTION_CONFIG.NAMESPACE_MAP {
    return AUTH_ENCRYPTION_CONFIG.NAMESPACE_MAP;
  }
}
