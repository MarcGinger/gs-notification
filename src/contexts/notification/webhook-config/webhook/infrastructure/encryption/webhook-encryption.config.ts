// @generated by gen v1.0.0 hash:regen
// REMOVE THIS COMMENT TO STOP AUTOMATIC UPDATES TO THIS BLOCK

/**
 * Webhook Encryption Configuration
 *
 * Domain-specific encryption configuration for Webhook entities.
 * Centralizes field mappings and namespace configuration to ensure
 * consistency across Writer, Reader, Query repositories and Projector.
 *
 * @domain Notification - NotificationWebhookConfig - Webhook
 * @layer Infrastructure - Configuration
 */

import { EncryptionConfig } from 'src/shared/infrastructure/encryption';
import { EventEncryptionFactory } from 'src/shared/infrastructure/encryption';

/**
 * Webhook domain-specific encryption field configuration
 */
export const WEBHOOK_ENCRYPTION_CONFIG = {
  /**
   * Fields that contain sensitive data requiring encryption
   */
  SENSITIVE_FIELDS: ['signingSecret'] as const,

  /**
   * Namespace mapping for different credential types
   * - signingSecret: Webhook-related secrets
   * - username/password: Authentication credentials
   */
  NAMESPACE_MAP: {
    signingSecret: 'auth',
  } as const,

  /**
   * Default namespace for general Webhook encryption operations
   */
  DEFAULT_NAMESPACE: 'webhook',
} as const;

/**
 * Webhook Encryption Configuration Helper
 *
 * Provides centralized configuration factory for Webhook domain encryption.
 * Ensures consistent field mappings and namespace configuration across all
 * Webhook repositories and projectors.
 */
export class WebhookEncryptionConfig {
  /**
   * Create SecretRef encryption configuration for Webhook domain
   *
   * @returns Configured EncryptionConfig for Webhook SecretRef encryption
   */
  static createSecretRefConfig(): EncryptionConfig {
    return EventEncryptionFactory.createSecretConfig({
      sensitiveFields: [...WEBHOOK_ENCRYPTION_CONFIG.SENSITIVE_FIELDS],
      namespaceMap: { ...WEBHOOK_ENCRYPTION_CONFIG.NAMESPACE_MAP },
      defaultNamespace: WEBHOOK_ENCRYPTION_CONFIG.DEFAULT_NAMESPACE,
    });
  }

  /**
   * Create Doppler encryption configuration for Webhook domain
   *
   * @returns Configured EncryptionConfig for Webhook Doppler encryption
   */
  static createDopplerConfig(): EncryptionConfig {
    return EventEncryptionFactory.createDopplerConfig({
      sensitiveFields: [...WEBHOOK_ENCRYPTION_CONFIG.SENSITIVE_FIELDS],
      namespaceMap: { ...WEBHOOK_ENCRYPTION_CONFIG.NAMESPACE_MAP },
      defaultNamespace: WEBHOOK_ENCRYPTION_CONFIG.DEFAULT_NAMESPACE,
    });
  }

  /**
   * Get sensitive field names for Webhook domain
   *
   * @returns Array of field names that require encryption
   */
  static getSensitiveFields(): readonly string[] {
    return WEBHOOK_ENCRYPTION_CONFIG.SENSITIVE_FIELDS;
  }

  /**
   * Get namespace mapping for Webhook credentials
   *
   * @returns Mapping of field names to namespace identifiers
   */
  static getNamespaceMap(): typeof WEBHOOK_ENCRYPTION_CONFIG.NAMESPACE_MAP {
    return WEBHOOK_ENCRYPTION_CONFIG.NAMESPACE_MAP;
  }
}
