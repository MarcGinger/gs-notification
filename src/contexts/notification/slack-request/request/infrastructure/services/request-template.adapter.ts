// @generated by gen v1.0.0 hash:regen
// REMOVE THIS COMMENT TO STOP AUTOMATIC UPDATES TO THIS BLOCK

import { Injectable } from '@nestjs/common';
import {
  TemplateRendererService,
  RenderableTemplate,
} from 'src/shared/infrastructure';
import type { TemplateReference } from '../../application/ports';

/**
 * Request Template Adapter
 *
 * Adapts the generic TemplateRendererService to work with Request's
 * TemplateReference interface. This provides a clean boundary between
 * the generic shared service and context-specific types.
 */
@Injectable()
export class RequestTemplateAdapter {
  constructor(private readonly templateRenderer: TemplateRendererService) {}

  /**
   * Render Request template using shared renderer
   */
  renderTemplate(opts: {
    template: TemplateReference;
    variables: Record<string, unknown>;
    maxBlocks?: number;
  }) {
    // Adapt TemplateReference to RenderableTemplate
    const renderableTemplate: RenderableTemplate = {
      code: opts.template.code,
      name: opts.template.name,
      description: opts.template.description,
      contentBlocks: opts.template.contentBlocks,
      variables: opts.template.variables,
      samplePayload: opts.template.samplePayload,
      enabled: opts.template.enabled,
    };

    return this.templateRenderer.renderTemplate({
      template: renderableTemplate,
      variables: opts.variables,
      maxBlocks: opts.maxBlocks,
    });
  }

  /**
   * Validate template blocks
   */
  validateTemplate(blocks: unknown[], maxBlocks?: number) {
    return this.templateRenderer.validateTemplate(blocks, maxBlocks);
  }
}
