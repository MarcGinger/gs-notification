// @generated by gen v1.0.0 hash:regen
// REMOVE THIS COMMENT TO STOP AUTOMATIC UPDATES TO THIS BLOCK

// Workspace Projector Module
// Configures Workspace Projector with shared projection infrastructure

import { Module } from '@nestjs/common';
import { TypeOrmModule } from '@nestjs/typeorm';
import { InfrastructureModule } from 'src/shared/infrastructure/infrastructure.module';
import { LoggingModule } from 'src/shared/logging';
import { TimeModule } from 'src/shared/infrastructure/time';
import {
  IO_REDIS,
  CACHE_SERVICE,
  CHECKPOINT_STORE,
  DATA_SOURCE,
  CATCHUP_RUNNER,
} from 'src/shared/constants/injection-tokens';
import { SLACK_REQUEST_DI_TOKENS } from '../slack-request.constants';

import { WorkspaceProjector } from './infrastructure/projectors';
import { WorkspaceProjectorHealthController } from './interface/http/controllers';

@Module({
  imports: [
    // Shared projection infrastructure (includes EventStore, Redis, CatchUpRunner, etc.)
    InfrastructureModule,

    // Time infrastructure (provides CLOCK token)
    TimeModule,

    // Logging infrastructure
    LoggingModule,

    // Database access for raw SQL operations
    TypeOrmModule.forFeature([]),
  ],
  providers: [
    // Map slack-request domain tokens to infrastructure tokens
    {
      provide: SLACK_REQUEST_DI_TOKENS.IO_REDIS, // 'SlackRequestRedisClient'
      useExisting: IO_REDIS, // 'IORedis'
    },
    {
      provide: SLACK_REQUEST_DI_TOKENS.DATA_SOURCE, // 'SlackRequestDataSource'
      useExisting: DATA_SOURCE, // 'DATA_SOURCE'
    },
    {
      provide: SLACK_REQUEST_DI_TOKENS.CHECKPOINT_STORE, // 'SlackRequestCheckpointStore'
      useExisting: CHECKPOINT_STORE, // 'CHECKPOINT_STORE'
    },
    {
      provide: SLACK_REQUEST_DI_TOKENS.CACHE_SERVICE, // 'SlackRequestCacheService'
      useExisting: CACHE_SERVICE, // 'CACHE_SERVICE'
    },
    {
      provide: SLACK_REQUEST_DI_TOKENS.CATCHUP_RUNNER, // 'SlackRequestCatchupRunner'
      useExisting: CATCHUP_RUNNER, // 'CATCHUP_RUNNER'
    },
    WorkspaceProjector,
  ],
  controllers: [WorkspaceProjectorHealthController],
  exports: [WorkspaceProjector],
})
export class WorkspaceProjectorModule {}
