// @generated by gen v1.0.0 hash:regen
// REMOVE THIS COMMENT TO STOP AUTOMATIC UPDATES TO THIS BLOCK

import { IsOptional, IsIn } from 'class-validator';
import {
  BaseListFilterRequest,
  SortFieldConfig,
  PaginationMetaResponse,
} from 'src/shared/application/dtos';
import { ApiListOf } from 'src/shared/application/decorators';
import { ApiPropertyOptional } from '@nestjs/swagger';
import {
  ApiLookupXxxCode,
  ApiLookupXxxListMeta,
  ApiLookupXxxName,
} from './decorators';
import { ListLookupXxxResponse } from './';
/**
 * LookupXxx list request DTO with pagination and filtering
 * Combines standardized pagination with lookup-xxx-specific filters
 * Uses simple string parameters for sorting instead of complex objects
 *
 * Available sort fields:
 * - name: Sort by name
 * - code: Sort by code
 *
 * Example usage:
 * - ?sortBy=name&sortOrder=asc
 * - ?sortBy=code&sortOrder=desc
 */
export class ListLookupXxxFilterRequest extends BaseListFilterRequest {
  @ApiLookupXxxName({ required: false })
  name?: string;

  @ApiLookupXxxCode({ required: false })
  code?: string;

  /**
   * Field to sort by - simple string parameter
   */
  @ApiPropertyOptional({
    enum: ['name', 'code'],
    description: 'Field to sort by',
    example: 'name',
    default: 'name',
  })
  @IsOptional()
  @IsIn(['name', 'code'])
  sortBy?: 'name' | 'code' = 'name';

  /**
   * Sort direction - simple string parameter
   */
  @ApiPropertyOptional({
    enum: ['asc', 'desc'],
    description: 'Sort direction',
    example: 'asc',
    default: 'asc',
  })
  @IsOptional()
  @IsIn(['asc', 'desc'])
  sortOrder?: 'asc' | 'desc' = 'asc';
  /**
   * Define available sort fields for lookupXxxs
   * This method ensures type-safe sorting validation
   *
   * Available sort fields:
   * - name: LookupXxx name (sortable, default: asc)
   * - code: LookupXxx code (sortable, default: asc)
   *
   * @returns Configuration object defining sortable fields and their properties
   */
  getSortFieldConfig(): SortFieldConfig {
    return {
      name: {
        description: 'LookupXxx name',
        sortable: true,
        defaultDirection: 'asc' as const,
      },
      code: {
        description: 'LookupXxx code',
        sortable: true,
        defaultDirection: 'asc' as const,
      },
    };
  }

  /**
   * Convert simple string parameters to the Record format expected by use cases
   * This maintains backward compatibility with existing use case implementations
   */
  getSortByRecord(): Record<string, 'asc' | 'desc'> {
    if (!this.sortBy) {
      return { name: 'asc' }; // Default sorting
    }
    return { [this.sortBy]: this.sortOrder || 'asc' };
  }

  /**
   * Validate that the sortBy field is allowed
   */
  validateSortFields(): boolean {
    if (!this.sortBy) return true;
    return ['name', 'code'].includes(this.sortBy);
  }
}

/**
 * LookupXxx page response DTO with metadata for pagination
 * Extends the generic PagedResponse pattern while maintaining API compatibility
 */
export class LookupXxxPageResponse {
  @ApiListOf(ListLookupXxxResponse)
  readonly data: ListLookupXxxResponse[];

  @ApiLookupXxxListMeta()
  readonly meta: PaginationMetaResponse;

  constructor(data: ListLookupXxxResponse[], meta: PaginationMetaResponse) {
    this.data = data;
    this.meta = meta;
  }

  /**
   * Static factory method for creating response instances
   */
  static create(
    data: ListLookupXxxResponse[],
    meta: PaginationMetaResponse,
  ): LookupXxxPageResponse {
    return new LookupXxxPageResponse(data, meta);
  }

  /**
   * Check if response has data
   */
  get isEmpty(): boolean {
    return this.data.length === 0;
  }

  /**
   * Get total count if available
   */
  get totalCount(): number | undefined {
    return this.meta.totalItems;
  }
}
