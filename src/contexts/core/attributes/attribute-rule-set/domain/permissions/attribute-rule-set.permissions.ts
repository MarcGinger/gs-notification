// @generated by gen v1.0.0 hash:regen
// REMOVE THIS COMMENT TO STOP AUTOMATIC UPDATES TO THIS BLOCK

import {
  PermissionRiskLevel,
  PermissionTenantScope,
  PermissionOperationType,
  BasePermissionMeta,
} from 'src/shared/domain/permissions';
import {
  createPermissionRegistry,
  createRoleHierarchy,
  assertRegistryComplete,
} from 'src/shared/domain/permissions/utils';
import { createDomainPermissionHelpers } from 'src/shared/domain/permissions/domain-permission-helpers.factory';

export enum AttributeRuleSetPermission {
  DOMAIN_ATTRIBUTE_RULE_SET_CREATE = 'DOMAIN_ATTRIBUTE_RULE_SET_CREATE',
  DOMAIN_ATTRIBUTE_RULE_SET_READ = 'DOMAIN_ATTRIBUTE_RULE_SET_READ',
  DOMAIN_ATTRIBUTE_RULE_SET_UPDATE = 'DOMAIN_ATTRIBUTE_RULE_SET_UPDATE',
  DOMAIN_ATTRIBUTE_RULE_SET_DELETE = 'DOMAIN_ATTRIBUTE_RULE_SET_DELETE',
  DOMAIN_ATTRIBUTE_RULE_SET_ADMIN = 'DOMAIN_ATTRIBUTE_RULE_SET_ADMIN',
  DOMAIN_ATTRIBUTE_RULE_SET_BULK_IMPORT = 'DOMAIN_ATTRIBUTE_RULE_SET_BULK_IMPORT',
  DOMAIN_ATTRIBUTE_RULE_SET_BULK_EXPORT = 'DOMAIN_ATTRIBUTE_RULE_SET_BULK_EXPORT',
  DOMAIN_ATTRIBUTE_RULE_SET_AUDIT_LOG = 'DOMAIN_ATTRIBUTE_RULE_SET_AUDIT_LOG',
}

// Permission registry using shared utilities
export const AttributeRuleSetPermissionRegistry = createPermissionRegistry<
  string,
  Record<string, BasePermissionMeta>
>({
  [AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_CREATE]: {
    description: 'Create attributeRuleSet records',
    riskLevel: PermissionRiskLevel.MEDIUM,
    requiresJustification: false,
    relatedPermissions: [],
    policyPath: 'TENANT.attribute-rule-set.attribute_rule_set_create',
    category: 'Core Operations',
    auditRequired: true,
    name: 'DOMAIN_ATTRIBUTE_RULE_SET_CREATE',
    action: 'attribute_rule_set_create',
    tags: ['crud', 'create'],
    operationType: PermissionOperationType.CRUD,
    policyRuleId: 'attribute-rule-set_attribute_rule_set_create',
    tenantScope: PermissionTenantScope.TENANT,
    i18nKey: 'permissions.attribute-rule-set.attribute_rule_set_create',
  },
  [AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_READ]: {
    description: 'Read attributeRuleSet records',
    riskLevel: PermissionRiskLevel.LOW,
    requiresJustification: false,
    relatedPermissions: [],
    policyPath: 'TENANT.attribute-rule-set.attribute_rule_set_read',
    category: 'Core Operations',
    auditRequired: false,
    name: 'DOMAIN_ATTRIBUTE_RULE_SET_READ',
    action: 'attribute_rule_set_read',
    tags: ['crud', 'read'],
    operationType: PermissionOperationType.CRUD,
    policyRuleId: 'attribute-rule-set_attribute_rule_set_read',
    tenantScope: PermissionTenantScope.TENANT,
    i18nKey: 'permissions.attribute-rule-set.attribute_rule_set_read',
  },
  [AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_UPDATE]: {
    description: 'Update attributeRuleSet records',
    riskLevel: PermissionRiskLevel.MEDIUM,
    requiresJustification: false,
    relatedPermissions: [
      AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_READ,
    ],
    policyPath: 'TENANT.attribute-rule-set.attribute_rule_set_update',
    category: 'Core Operations',
    auditRequired: true,
    name: 'DOMAIN_ATTRIBUTE_RULE_SET_UPDATE',
    action: 'attribute_rule_set_update',
    tags: ['crud', 'update'],
    operationType: PermissionOperationType.CRUD,
    policyRuleId: 'attribute-rule-set_attribute_rule_set_update',
    tenantScope: PermissionTenantScope.TENANT,
    i18nKey: 'permissions.attribute-rule-set.attribute_rule_set_update',
  },
  [AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_DELETE]: {
    description: 'Delete attributeRuleSet records',
    riskLevel: PermissionRiskLevel.HIGH,
    requiresJustification: true,
    relatedPermissions: [
      AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_READ,
      AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_UPDATE,
    ],
    policyPath: 'TENANT.attribute-rule-set.attribute_rule_set_delete',
    category: 'Core Operations',
    auditRequired: true,
    name: 'DOMAIN_ATTRIBUTE_RULE_SET_DELETE',
    action: 'attribute_rule_set_delete',
    tags: ['crud', 'delete'],
    operationType: PermissionOperationType.CRUD,
    policyRuleId: 'attribute-rule-set_attribute_rule_set_delete',
    tenantScope: PermissionTenantScope.TENANT,
    i18nKey: 'permissions.attribute-rule-set.attribute_rule_set_delete',
  },
  [AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_ADMIN]: {
    description: 'Full administrative access to attributeRuleSet',
    riskLevel: PermissionRiskLevel.CRITICAL,
    requiresJustification: true,
    relatedPermissions: [
      AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_CREATE,
      AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_READ,
      AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_UPDATE,
      AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_DELETE,
    ],
    policyPath: 'TENANT.attribute-rule-set.attribute_rule_set_admin',
    category: 'Administrative',
    auditRequired: true,
    name: 'DOMAIN_ATTRIBUTE_RULE_SET_ADMIN',
    action: 'attribute_rule_set_admin',
    tags: ['admin', 'full-access'],
    operationType: PermissionOperationType.ADMIN,
    policyRuleId: 'attribute-rule-set_attribute_rule_set_admin',
    tenantScope: PermissionTenantScope.TENANT,
    i18nKey: 'permissions.attribute-rule-set.attribute_rule_set_admin',
  },
  [AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_BULK_IMPORT]: {
    description: 'Bulk import attributeRuleSet records',
    riskLevel: PermissionRiskLevel.HIGH,
    requiresJustification: true,
    relatedPermissions: [],
    policyPath: 'TENANT.attribute-rule-set.attribute_rule_set_bulk_import',
    category: 'Bulk Operations',
    auditRequired: true,
    name: 'DOMAIN_ATTRIBUTE_RULE_SET_BULK_IMPORT',
    action: 'attribute_rule_set_bulk_import',
    tags: ['bulk', 'import'],
    operationType: PermissionOperationType.BULK,
    policyRuleId: 'attribute-rule-set_attribute_rule_set_bulk_import',
    tenantScope: PermissionTenantScope.TENANT,
    i18nKey: 'permissions.attribute-rule-set.attribute_rule_set_bulk_import',
  },
  [AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_BULK_EXPORT]: {
    description: 'Bulk export attributeRuleSet records',
    riskLevel: PermissionRiskLevel.HIGH,
    requiresJustification: true,
    relatedPermissions: [],
    policyPath: 'TENANT.attribute-rule-set.attribute_rule_set_bulk_export',
    category: 'Bulk Operations',
    auditRequired: true,
    name: 'DOMAIN_ATTRIBUTE_RULE_SET_BULK_EXPORT',
    action: 'attribute_rule_set_bulk_export',
    tags: ['bulk', 'export'],
    operationType: PermissionOperationType.BULK,
    policyRuleId: 'attribute-rule-set_attribute_rule_set_bulk_export',
    tenantScope: PermissionTenantScope.TENANT,
    i18nKey: 'permissions.attribute-rule-set.attribute_rule_set_bulk_export',
  },
  [AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_AUDIT_LOG]: {
    description: 'Access attributeRuleSet audit logs',
    riskLevel: PermissionRiskLevel.HIGH,
    requiresJustification: true,
    relatedPermissions: [],
    policyPath: 'TENANT.attribute-rule-set.attribute_rule_set_audit_log',
    category: 'Audit & Compliance',
    auditRequired: true,
    name: 'DOMAIN_ATTRIBUTE_RULE_SET_AUDIT_LOG',
    action: 'attribute_rule_set_audit_log',
    tags: ['audit', 'logs'],
    operationType: PermissionOperationType.SENSITIVE,
    policyRuleId: 'attribute-rule-set_attribute_rule_set_audit_log',
    tenantScope: PermissionTenantScope.TENANT,
    i18nKey: 'permissions.attribute-rule-set.attribute_rule_set_audit_log',
  },
});

// Role hierarchy using shared utilities
export const AttributeRuleSetPermissionHierarchy = createRoleHierarchy<
  string,
  Record<string, readonly string[]>
>({
  AttributeRuleSetViewer: [
    AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_READ,
  ],
  AttributeRuleSetEditor: [
    AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_CREATE,
    AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_READ,
    AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_UPDATE,
  ],
  AttributeRuleSetManager: [
    AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_CREATE,
    AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_READ,
    AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_UPDATE,
    AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_DELETE,
    AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_BULK_IMPORT,
    AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_BULK_EXPORT,
    AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_AUDIT_LOG,
  ],
  AttributeRuleSetAdmin: [
    AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_CREATE,
    AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_READ,
    AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_UPDATE,
    AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_DELETE,
    AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_ADMIN,
    AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_BULK_IMPORT,
    AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_BULK_EXPORT,
    AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_AUDIT_LOG,
  ],
});

// Runtime completeness validation
const ALL_ATTRIBUTE_RULE_SET_PERMISSIONS = Object.values(
  AttributeRuleSetPermission,
);
assertRegistryComplete(
  ALL_ATTRIBUTE_RULE_SET_PERMISSIONS,
  AttributeRuleSetPermissionRegistry,
);

/**
 * AttributeRuleSet-specific field permission matrix for field-level security
 */
const ATTRIBUTE_RULE_SET_FIELD_PERMISSION_MATRIX = {
  metadata: [AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_ADMIN],
  bulkImport: [
    AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_BULK_IMPORT,
  ],
  bulkExport: [
    AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_BULK_EXPORT,
  ],
} as const;

/**
 * Factory-generated AttributeRuleSetPermissionHelpers with full functionality
 * This includes all methods needed by the authorization system:
 * - getRiskLevel, requiresJustification, isHighRisk
 * - getPolicyPath, requiresAudit (needed by attribute-rule-set.resource.ts)
 * - getByRiskLevel, expandWithRelated, etc.
 * - Field-level permission logic with FIELD_PERMISSION_MATRIX
 */
export const AttributeRuleSetPermissionHelpers = createDomainPermissionHelpers({
  domain: 'attribute-rule-set',
  permissions: AttributeRuleSetPermission,
  registry: AttributeRuleSetPermissionRegistry,
  fieldMatrix: ATTRIBUTE_RULE_SET_FIELD_PERMISSION_MATRIX,
});

// Add domain-specific convenience methods
export const AttributeRuleSetPermissionUtils = {
  /**
   * Get minimum permissions for basic attributeRuleSet management
   */
  getBasicManagementPermissions(): AttributeRuleSetPermission[] {
    return [
      AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_READ,
      AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_CREATE,
      AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_UPDATE,
    ];
  },

  /**
   * Check if user can perform bulk operations
   */
  canPerformBulkOperations(
    userPermissions: AttributeRuleSetPermission[],
  ): boolean {
    return [
      AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_BULK_IMPORT,
      AttributeRuleSetPermission.DOMAIN_ATTRIBUTE_RULE_SET_BULK_EXPORT,
    ].some((perm) => userPermissions.includes(perm));
  },
} as const;
